<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Sensitive Data Scanner</title><style>body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:16px;background-color:#f8f9fa;color:#333;line-height:1.5}.header{background:linear-gradient(135deg,#0078d4,#106ebe);color:#fff;padding:20px;margin:-16px -16px 20px -16px;border-radius:0 0 8px 8px;text-align:center}.header h1{margin:0;font-size:18px;font-weight:600}.header p{margin:8px 0 0 0;font-size:14px;opacity:.9}.section{background:#fff;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.section h3{margin:0 0 12px 0;color:#323130;font-size:16px;font-weight:600}.keyword-stats{display:flex;align-items:center;gap:8px;margin-bottom:12px}.keyword-count{background:#0078d4;color:#fff;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:600}.keywords-list{max-height:200px;overflow-y:auto;border:1px solid #e1e1e1;border-radius:4px;padding:8px;background:#fafafa}.keywords-list ul{margin:0;padding:0;list-style:none}.keyword-item{background:#e3f2fd;color:#1565c0;padding:6px 10px;margin:4px 0;border-radius:4px;font-size:13px;border-left:3px solid #1976d2}.button-group{display:flex;gap:8px;margin-top:16px}.btn{flex:1;padding:10px 16px;border:none;border-radius:4px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-primary{background:#0078d4;color:#fff}.btn-primary:hover{background:#106ebe}.btn-secondary{background:#6c757d;color:#fff}.btn-secondary:hover{background:#5a6268}.scan-result{margin-top:16px;padding:16px;border-radius:6px;border-left:4px solid}.scan-result.success{background:#d4edda;border-left-color:#28a745;color:#155724}.scan-result.warning{background:#fff3cd;border-left-color:#ffc107;color:#856404}.scan-result h4{margin:0 0 8px 0;font-size:14px}.found-keyword{background:#dc3545;color:#fff;padding:2px 6px;border-radius:3px;font-size:12px;margin:2px 0}.error{color:#dc3545;font-weight:500}.info-item{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #e9ecef}.info-item:last-child{border-bottom:none}.info-label{font-weight:600;color:#495057}.info-value{color:#6c757d}.status-indicator{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:8px}.status-active{background:#28a745}.status-inactive{background:#6c757d}</style><script defer="defer" src="vendors.js"></script><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><div class="header"><h1>üõ°Ô∏è Sensitive Data Scanner</h1><p>Protecting your organization from data leaks</p></div><div class="section"><h3><span class="status-indicator status-active"></span> Scanner Status</h3><p>The scanner is active and will automatically check outgoing emails and calendar invitations for sensitive content.</p><div id="current-item-info"><div class="info-item"><span class="info-label">Status:</span> <span class="info-value">Ready</span></div></div><div class="button-group"><button id="refresh-info" class="btn btn-secondary">Refresh Info</button> <button id="scan-current-item" class="btn btn-primary">Scan Current Item</button></div><div id="scan-results"></div></div><div class="section"><h3>Monitored Keywords</h3><div class="keyword-stats"><span>Currently monitoring</span> <span id="keyword-count" class="keyword-count">0</span> <span>sensitive keywords</span></div><div class="keywords-list"><ul id="keywords-list"></ul></div></div><div class="section"><h3>How It Works</h3><ol style="margin:0;padding-left:20px"><li>When you click "Send" on an email or calendar invitation, the scanner automatically activates</li><li>It searches the content for any of the monitored keywords (case-insensitive)</li><li>If sensitive content is detected, sending is blocked and you'll see a warning</li><li>You can choose to send anyway or edit the content to remove sensitive information</li></ol></div><script>function updateDebugInfo(){const e=document.querySelector(".info-value");if(e){const o=navigator.onLine,n="serviceWorker"in navigator&&navigator.serviceWorker.controller?"Active":"Registering";e.textContent=`${o?"Online":"Offline"} - SW: ${n}`}}if(console.log("üöÄ Taskpane loaded at:",(new Date).toISOString()),"serviceWorker"in navigator){function registerServiceWorker(){const e="./sw.js";return console.log("üìù Taskpane: Attempting to register SW at:",e),console.log("üìç Taskpane: From GitHub Pages:",window.location.origin),navigator.serviceWorker.register(e,{scope:"./",updateViaCache:"none"}).then(e=>(console.log("‚úÖ Taskpane: Service Worker registered"),console.log("üì¶ Scope:",e.scope),updateDebugInfo(),e.waiting&&(console.log("üîÑ Taskpane: Activating waiting service worker"),e.waiting.postMessage({type:"SKIP_WAITING"})),e)).catch(e=>{console.error("‚ùå Taskpane: Service Worker registration failed:",e);const o=document.querySelector(".info-value");return o&&e.message.includes("SSL")&&(o.textContent="SSL Certificate Issue - See Console",o.style.color="#dc3545"),(e.message.includes("SSL")||e.message.includes("certificate"))&&console.warn("‚ö†Ô∏è Taskpane: GitHub Pages SSL Certificate Issue - check network connection"),null})}console.log("üì± Taskpane: Service Worker supported"),registerServiceWorker(),navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("üîÑ Taskpane: Service Worker controller changed"),updateDebugInfo()})}else console.warn("‚ö†Ô∏è Taskpane: Service Worker not supported");window.addEventListener("online",()=>{console.log("üü¢ Taskpane: Network ONLINE"),updateDebugInfo()}),window.addEventListener("offline",()=>{console.log("üî¥ Taskpane: Network OFFLINE - should work from cache"),updateDebugInfo()}),setInterval(updateDebugInfo,1e3),setTimeout(updateDebugInfo,100)</script></body></html>