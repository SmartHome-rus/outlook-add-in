!function(){"use strict";var e={d:function(o,n){for(var t in n)e.o(n,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:n[t]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},Office.onReady(()=>{console.log("Office is ready")});const o=["confidential","internal use only","secret","project-alpha","classified","proprietary","restricted","private","sensitive","do not distribute","for internal use","confidential information","trade secret","intellectual property","proprietary information"];function n(e){if(!e)return{hasKeywords:!1,foundKeywords:[]};const n=[],t=e.toLowerCase();for(const e of o)t.includes(e.toLowerCase())&&n.push(e);return{hasKeywords:n.length>0,foundKeywords:n}}function t(e){var o;console.log("OnMessageSend event triggered"),null===(o=Office.context.mailbox.item)||void 0===o||o.body.getAsync(Office.CoercionType.Text,o=>{var t;if(o.status===Office.AsyncResultStatus.Succeeded){const t=n(o.value||"");if(t.hasKeywords){console.log("Sensitive keywords found:",t.foundKeywords);const o=`This email contains potentially sensitive content (found: ${t.foundKeywords.join(", ")}). Please review before sending.`;e.completed({allowEvent:!1,errorMessage:o})}else console.log("No sensitive keywords found, allowing send"),e.completed({allowEvent:!0})}else console.error("Failed to get email body:",null===(t=o.error)||void 0===t?void 0:t.message),e.completed({allowEvent:!0})})}function i(e){var o;console.log("OnAppointmentSend event triggered"),null===(o=Office.context.mailbox.item)||void 0===o||o.body.getAsync(Office.CoercionType.Text,o=>{var t;if(o.status===Office.AsyncResultStatus.Succeeded){const t=n(o.value||"");if(t.hasKeywords){console.log("Sensitive keywords found in appointment:",t.foundKeywords);const o=`This appointment contains potentially sensitive content (found: ${t.foundKeywords.join(", ")}). Please review before sending.`;e.completed({allowEvent:!1,errorMessage:o})}else console.log("No sensitive keywords found in appointment, allowing send"),e.completed({allowEvent:!0})}else console.error("Failed to get appointment body:",null===(t=o.error)||void 0===t?void 0:t.message),e.completed({allowEvent:!0})})}function s(e){console.log("OnNewMessageCompose event triggered"),e.completed()}function r(e){console.log("OnNewAppointmentOrganizer event triggered"),e.completed()}"undefined"!=typeof window&&(window.onMessageSendHandler=t,window.onAppointmentSendHandler=i,window.onNewMessageComposeHandler=s,window.onNewAppointmentOrganizerHandler=r),void 0!==e.g&&(e.g.onMessageSendHandler=t,e.g.onAppointmentSendHandler=i,e.g.onNewMessageComposeHandler=s,e.g.onNewAppointmentOrganizerHandler=r)}();
//# sourceMappingURL=commands.js.map