!function(){"use strict";var e={d:function(o,n){for(var t in n)e.o(n,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:n[t]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},Office.onReady(e=>{var o,n,t;console.log("‚úÖ Office.js is ready"),console.log("üìä Host:",e.host),console.log("üìä Platform:",e.platform),console.log("üìä Context available:",!!Office.context),console.log("üìä Mailbox available:",!!(null===(o=Office.context)||void 0===o?void 0:o.mailbox)),console.log("üìä Item available:",!!(null===(t=null===(n=Office.context)||void 0===n?void 0:n.mailbox)||void 0===t?void 0:t.item)),"undefined"!=typeof window&&console.log("üì¶ Event handlers registered:",{onMessageSendHandler:typeof window.onMessageSendHandler,onAppointmentSendHandler:typeof window.onAppointmentSendHandler})});const o=["confidential","internal use only","secret","project-alpha","classified","proprietary","restricted","private","sensitive","do not distribute","for internal use","confidential information","trade secret","intellectual property","proprietary information"];function n(e){if(!e)return{hasKeywords:!1,foundKeywords:[]};const n=[],t=e.toLowerCase();for(const e of o)t.includes(e.toLowerCase())&&n.push(e);return{hasKeywords:n.length>0,foundKeywords:n}}function t(e){var o,t;console.log("OnMessageSend event triggered");const i=setTimeout(()=>{console.warn("‚ö†Ô∏è OnMessageSend handler timed out - allowing send to proceed"),e.completed({allowEvent:!0})},3e3);try{if(!(null===(t=null===(o=null===Office||void 0===Office?void 0:Office.context)||void 0===o?void 0:o.mailbox)||void 0===t?void 0:t.item))return console.warn("‚ö†Ô∏è Office context or item not available - allowing send"),clearTimeout(i),void e.completed({allowEvent:!0});if(!Office.context.mailbox.item.body)return console.warn("‚ö†Ô∏è Item body not accessible - allowing send"),clearTimeout(i),void e.completed({allowEvent:!0});Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,o=>{var t;if(clearTimeout(i),o.status===Office.AsyncResultStatus.Succeeded){const t=n(o.value||"");if(t.hasKeywords){console.log("üö´ Sensitive keywords found:",t.foundKeywords);const o=`This email contains potentially sensitive content (found: ${t.foundKeywords.join(", ")}). Please review before sending.`;e.completed({allowEvent:!1,errorMessage:o})}else console.log("‚úÖ No sensitive keywords found, allowing send"),e.completed({allowEvent:!0})}else console.error("‚ùå Failed to get email body:",null===(t=o.error)||void 0===t?void 0:t.message),e.completed({allowEvent:!0})})}catch(o){console.error("‚ùå Exception in onMessageSendHandler:",o),clearTimeout(i),e.completed({allowEvent:!0})}}function i(e){var o,t;console.log("OnAppointmentSend event triggered");const i=setTimeout(()=>{console.warn("‚ö†Ô∏è OnAppointmentSend handler timed out - allowing send to proceed"),e.completed({allowEvent:!0})},3e3);try{if(!(null===(t=null===(o=null===Office||void 0===Office?void 0:Office.context)||void 0===o?void 0:o.mailbox)||void 0===t?void 0:t.item))return console.warn("‚ö†Ô∏è Office context or item not available - allowing appointment send"),clearTimeout(i),void e.completed({allowEvent:!0});if(!Office.context.mailbox.item.body)return console.warn("‚ö†Ô∏è Item body not accessible - allowing appointment send"),clearTimeout(i),void e.completed({allowEvent:!0});Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,o=>{var t;if(clearTimeout(i),o.status===Office.AsyncResultStatus.Succeeded){const t=n(o.value||"");if(t.hasKeywords){console.log("üö´ Sensitive keywords found in appointment:",t.foundKeywords);const o=`This appointment contains potentially sensitive content (found: ${t.foundKeywords.join(", ")}). Please review before sending.`;e.completed({allowEvent:!1,errorMessage:o})}else console.log("‚úÖ No sensitive keywords found in appointment, allowing send"),e.completed({allowEvent:!0})}else console.error("‚ùå Failed to get appointment body:",null===(t=o.error)||void 0===t?void 0:t.message),e.completed({allowEvent:!0})})}catch(o){console.error("‚ùå Exception in onAppointmentSendHandler:",o),clearTimeout(i),e.completed({allowEvent:!0})}}function l(e){console.log("OnNewMessageCompose event triggered"),e.completed()}function r(e){console.log("OnNewAppointmentOrganizer event triggered"),e.completed()}"undefined"!=typeof window&&(window.onMessageSendHandler=t,window.onAppointmentSendHandler=i,window.onNewMessageComposeHandler=l,window.onNewAppointmentOrganizerHandler=r),void 0!==e.g&&(e.g.onMessageSendHandler=t,e.g.onAppointmentSendHandler=i,e.g.onNewMessageComposeHandler=l,e.g.onNewAppointmentOrganizerHandler=r)}();
//# sourceMappingURL=commands.js.map