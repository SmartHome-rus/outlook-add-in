(()=>{"use strict";Object.onMessageSendHandler=async function(e){try{const t=navigator.onLine;if(!await async function(){return new Promise(e=>{var t;const n=null===(t=Office.context.mailbox)||void 0===t?void 0:t.item;n?n.body.getAsync(Office.CoercionType.Html,t=>{if(t.status===Office.AsyncResultStatus.Succeeded){const n=t.value||"";e(new RegExp("\\btest\\b","i").test(n))}else e(!1)}):e(!1)})}())return void e.completed({allowEvent:!0});if(!t)return void e.completed({allowEvent:!0});const n=await new Promise(e=>{const t=new URL(window.location.origin+"/dialog.html");Office.context.ui.displayDialogAsync(t.toString(),{height:30,width:30,displayInIframe:!0},t=>{if(t.status!==Office.AsyncResultStatus.Succeeded)return void e(!0);const n=t.value;n.addEventHandler(Office.EventType.DialogMessageReceived,t=>{try{"proceedSend"===JSON.parse(t.message).action&&(n.close(),e(!0))}catch{n.close(),e(!0)}}),n.addEventHandler(Office.EventType.DialogEventReceived,()=>{e(!0)})})});e.completed({allowEvent:n})}catch{e.completed({allowEvent:!0})}}})();