!function(){"use strict";var e={30544:function(e,n,o){o.d(n,{O0:function(){return t}}),Office.onReady(()=>{console.log("Office is ready")});const t=["confidential","internal use only","secret","project-alpha","classified","proprietary","restricted","private","sensitive","do not distribute","for internal use","confidential information","trade secret","intellectual property","proprietary information"];function i(e){if(!e)return{hasKeywords:!1,foundKeywords:[]};const n=[],o=e.toLowerCase();for(const e of t)o.includes(e.toLowerCase())&&n.push(e);return{hasKeywords:n.length>0,foundKeywords:n}}function s(e){var n;console.log("OnMessageSend event triggered"),null===(n=Office.context.mailbox.item)||void 0===n||n.body.getAsync(Office.CoercionType.Text,n=>{var o;if(n.status===Office.AsyncResultStatus.Succeeded){const o=i(n.value||"");if(o.hasKeywords){console.log("Sensitive keywords found:",o.foundKeywords);const n=`This email contains potentially sensitive content (found: ${o.foundKeywords.join(", ")}). Please review before sending.`;e.completed({allowEvent:!1,errorMessage:n})}else console.log("No sensitive keywords found, allowing send"),e.completed({allowEvent:!0})}else console.error("Failed to get email body:",null===(o=n.error)||void 0===o?void 0:o.message),e.completed({allowEvent:!0})})}function r(e){var n;console.log("OnAppointmentSend event triggered"),null===(n=Office.context.mailbox.item)||void 0===n||n.body.getAsync(Office.CoercionType.Text,n=>{var o;if(n.status===Office.AsyncResultStatus.Succeeded){const o=i(n.value||"");if(o.hasKeywords){console.log("Sensitive keywords found in appointment:",o.foundKeywords);const n=`This appointment contains potentially sensitive content (found: ${o.foundKeywords.join(", ")}). Please review before sending.`;e.completed({allowEvent:!1,errorMessage:n})}else console.log("No sensitive keywords found in appointment, allowing send"),e.completed({allowEvent:!0})}else console.error("Failed to get appointment body:",null===(o=n.error)||void 0===o?void 0:o.message),e.completed({allowEvent:!0})})}function c(e){console.log("OnNewMessageCompose event triggered"),e.completed()}function l(e){console.log("OnNewAppointmentOrganizer event triggered"),e.completed()}"undefined"!=typeof window&&(window.onMessageSendHandler=s,window.onAppointmentSendHandler=r,window.onNewMessageComposeHandler=c,window.onNewAppointmentOrganizerHandler=l),void 0!==o.g&&(o.g.onMessageSendHandler=s,o.g.onAppointmentSendHandler=r,o.g.onNewMessageComposeHandler=c,o.g.onNewAppointmentOrganizerHandler=l)}},n={};function o(t){var i=n[t];if(void 0!==i)return i.exports;var s=n[t]={exports:{}};return e[t](s,s.exports,o),s.exports}o.d=function(e,n){for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)};var t=o(30544);function i(){var e;const n=document.getElementById("current-item-info");if(n)if(Office.context.mailbox.item){const o=Office.context.mailbox.item;let t="Unknown";o.itemType===Office.MailboxEnums.ItemType.Message?t="Email":o.itemType===Office.MailboxEnums.ItemType.Appointment&&(t="Appointment"),n.innerHTML=`\n      <h3>Current Item</h3>\n      <p><strong>Type:</strong> ${t}</p>\n      <p><strong>Subject:</strong> ${o.subject||"No subject"}</p>\n      <p><strong>Mode:</strong> ${(null===(e=o.itemClass)||void 0===e?void 0:e.includes("Compose"))?"Compose":"Read"}</p>\n    `}else n.innerHTML="\n      <h3>Current Item</h3>\n      <p>No item is currently selected or available.</p>\n    "}function s(){const e=document.getElementById("scan-results");e&&(e.innerHTML="<p>Scanning...</p>",Office.context.mailbox.item?Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,n=>{var o;if(n.status===Office.AsyncResultStatus.Succeeded){const o=[],i=(n.value||"").toLowerCase();for(const e of t.O0)i.includes(e.toLowerCase())&&o.push(e);o.length>0?e.innerHTML=`\n          <div class="scan-result warning">\n            <h4>⚠️ Sensitive Content Detected</h4>\n            <p>Found ${o.length} potentially sensitive keyword(s):</p>\n            <ul>\n              ${o.map(e=>`<li class="found-keyword">${e}</li>`).join("")}\n            </ul>\n            <p><strong>Recommendation:</strong> Review and remove sensitive content before sending.</p>\n          </div>\n        `:e.innerHTML='\n          <div class="scan-result success">\n            <h4>✅ No Sensitive Content Detected</h4>\n            <p>No sensitive keywords were found in this item.</p>\n          </div>\n        '}else e.innerHTML=`<p class="error">Failed to scan item: ${null===(o=n.error)||void 0===o?void 0:o.message}</p>`}):e.innerHTML='<p class="error">No item available to scan.</p>')}Office.onReady(e=>{e.host===Office.HostType.Outlook&&document.addEventListener("DOMContentLoaded",function(){console.log("Initializing Sensitive Data Scanner taskpane"),function(){const e=document.getElementById("keywords-list");if(e){e.innerHTML="",t.O0.forEach(n=>{const o=document.createElement("li");o.className="keyword-item",o.textContent=n,e.appendChild(o)});const n=document.getElementById("keyword-count");n&&(n.textContent=t.O0.length.toString())}}(),function(){const e=document.getElementById("scan-current-item");e&&e.addEventListener("click",s);const n=document.getElementById("refresh-info");n&&n.addEventListener("click",i)}(),i()})})}();
//# sourceMappingURL=taskpane.js.map