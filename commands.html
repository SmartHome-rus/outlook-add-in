<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Sensitive Data Scanner - Commands</title><script defer="defer" src="vendors.js"></script><script defer="defer" src="polyfill.js"></script><script defer="defer" src="commands.js"></script></head><body><div style="display:none"><h1>Sensitive Data Scanner - Event Handler</h1><p>This page hosts the event-based activation functions for the Sensitive Data Scanner add-in.</p><p>The functions defined here will be called automatically when users attempt to send emails or calendar invitations.</p></div><script>if(console.log("üöÄ Commands page loaded at:",(new Date).toISOString()),console.log("üåê Navigator online:",navigator.onLine),console.log("üìç Current URL:",window.location.href),"serviceWorker"in navigator){function registerServiceWorker(){const e="./sw.js";return console.log("üìù Attempting to register SW at:",e),console.log("üìç From GitHub Pages:",window.location.origin),navigator.serviceWorker.register(e,{scope:"./",updateViaCache:"none"}).then(e=>(console.log("‚úÖ Service Worker registered successfully"),console.log("üì¶ Scope:",e.scope),console.log("üì¶ State:",e.active?.state),console.log("üì¶ Installing state:",e.installing?.state),console.log("üì¶ Waiting state:",e.waiting?.state),e.waiting&&(console.log("üîÑ Activating waiting service worker"),e.waiting.postMessage({type:"SKIP_WAITING"})),e.installing&&e.installing.addEventListener("statechange",e=>{console.log("üîÑ SW state changed to:",e.target.state)}),e)).catch(e=>{if(console.error("‚ùå Service Worker registration failed:",e),console.error("‚ùå Error type:",e.constructor.name),console.error("‚ùå Error message:",e.message),e.message.includes("SSL")||e.message.includes("certificate")){console.warn("‚ö†Ô∏è GitHub Pages SSL Certificate Issue Detected"),console.warn("‚ö†Ô∏è This should not happen with GitHub Pages - check network connection"),console.warn('‚ö†Ô∏è Use browser Developer Tools Network tab "Offline" mode for testing');const e=document.createElement("div");e.style.cssText="\n                            position: fixed; top: 10px; right: 10px; z-index: 10000;\n                            background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\n                            padding: 12px; font-family: 'Segoe UI', sans-serif; font-size: 12px;\n                            max-width: 300px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n                        ",e.innerHTML='\n                            <strong>‚ö†Ô∏è Offline Mode Setup Needed</strong><br>\n                            Visit <a href="/sw.js" target="_blank" style="color: #0078d4;">localhost:3000/sw.js</a> \n                            and accept the SSL certificate for offline functionality.\n                        ',document.body.appendChild(e),setTimeout(()=>e.remove(),1e4)}return null})}console.log("üì± Service Worker supported"),registerServiceWorker().then(e=>{e?console.log("üéâ Service Worker successfully registered for offline support"):(console.log("‚ö†Ô∏è Service Worker failed - using browser cache fallback"),implementBrowserCacheFallback())}),navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("üîÑ Service Worker controller changed - add-in now cached for offline use")})}else console.warn("‚ö†Ô∏è Service Worker not supported in this environment");function checkOfficeJs(){if("undefined"!=typeof Office){console.log("‚úÖ Office.js is available");try{Office.context?(console.log("üìä Office Host:",Office.context.host?.name||"Unknown"),console.log("üìä Office Platform:",Office.context.platform||"Unknown"),console.log("üìä Office Requirements:",Office.context.requirements?.isSetSupported("Mailbox","1.1")||"Unknown")):console.log("üìä Office context not yet available, but Office.js loaded")}catch(e){console.log("üìä Office.js loaded but context access failed:",e.message)}return!0}return console.log("‚è≥ Waiting for Office.js..."),!1}window.addEventListener("online",()=>{console.log("üü¢ Network: ONLINE")}),window.addEventListener("offline",()=>{console.log("üî¥ Network: OFFLINE - Add-in should work from cache")});let officeLoadAttempts=0;const maxAttempts=20;function initializeOfficeJs(){if(officeLoadAttempts++,!checkOfficeJs())return officeLoadAttempts>=20?(console.warn("‚ö†Ô∏è Office.js not loaded after 10 seconds"),console.warn("‚ö†Ô∏è This is normal if testing outside Outlook environment"),console.warn("‚ö†Ô∏è Add-in event handlers will still be registered for when Office.js loads"),void("undefined"!=typeof window&&console.log("üì¶ Registering event handlers anyway..."))):void setTimeout(initializeOfficeJs,500);console.log("üéâ Office.js loaded successfully after",officeLoadAttempts,"attempts")}initializeOfficeJs()</script></body></html>