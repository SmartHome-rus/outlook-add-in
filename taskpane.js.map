{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://sensitive-data-scanner-outlook-addin/./node_modules/html-loader/dist/runtime/getUrl.js","webpack://sensitive-data-scanner-outlook-addin/./src/commands/commands.ts","webpack://sensitive-data-scanner-outlook-addin/webpack/bootstrap","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/compat get default export","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/define property getters","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/global","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/hasOwnProperty shorthand","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/make namespace object","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/publicPath","webpack://sensitive-data-scanner-outlook-addin/webpack/runtime/jsonp chunk loading","webpack://sensitive-data-scanner-outlook-addin/./src/taskpane/taskpane.ts","webpack://sensitive-data-scanner-outlook-addin/./src/taskpane/taskpane.html"],"sourcesContent":["\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n\n  if (!url) {\n    return url;\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = String(url.__esModule ? url.default : url);\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n\n  return url;\n};","/**\n * Sensitive Data Scanner - On-Send Event Handlers\n * This file contains the core logic for scanning emails and appointments\n * for sensitive keywords and blocking sending when found.\n */\n/// <reference path=\"../types/office.d.ts\" />\n// Define the list of sensitive keywords (case-insensitive)\nconst SENSITIVE_KEYWORDS = [\n    'confidential',\n    'internal use only',\n    'secret',\n    'project-alpha',\n    'classified',\n    'restricted',\n    'proprietary',\n    'do not distribute',\n    'sensitive',\n    'private and confidential'\n];\n/**\n * Scans text content for sensitive keywords\n * @param content - The text content to scan\n * @returns Array of found keywords\n */\nfunction scanForSensitiveKeywords(content) {\n    if (!content)\n        return [];\n    const normalizedContent = content.toLowerCase();\n    const foundKeywords = [];\n    for (const keyword of SENSITIVE_KEYWORDS) {\n        if (normalizedContent.includes(keyword.toLowerCase())) {\n            foundKeywords.push(keyword);\n        }\n    }\n    return foundKeywords;\n}\n/**\n * Extracts text content from HTML body\n * @param htmlContent - HTML content to extract text from\n * @returns Plain text content\n */\nfunction extractTextFromHtml(htmlContent) {\n    if (!htmlContent)\n        return '';\n    // Remove HTML tags and decode common HTML entities\n    const textContent = htmlContent\n        .replace(/<[^>]*>/g, ' ') // Remove HTML tags\n        .replace(/&nbsp;/g, ' ') // Replace non-breaking spaces\n        .replace(/&amp;/g, '&') // Decode ampersands\n        .replace(/&lt;/g, '<') // Decode less than\n        .replace(/&gt;/g, '>') // Decode greater than\n        .replace(/&quot;/g, '\"') // Decode quotes\n        .replace(/&#39;/g, \"'\") // Decode apostrophes\n        .replace(/\\s+/g, ' ') // Replace multiple whitespace with single space\n        .trim();\n    return textContent;\n}\n/**\n * Handler for message send events (emails)\n * @param event - The Office.js event object\n */\nfunction onMessageSendHandler(event) {\n    console.log('Message send handler triggered');\n    // Get the current item (email being sent)\n    const item = Office.context.mailbox.item;\n    if (!item) {\n        console.error('No item found');\n        event.completed({ allowEvent: true });\n        return;\n    }\n    // Get the body of the email\n    item.body.getAsync(Office.CoercionType.Html, (result) => {\n        if (result.status === Office.AsyncResultStatus.Failed) {\n            console.error('Failed to get email body:', result.error);\n            // Allow sending if we can't get the body\n            event.completed({ allowEvent: true });\n            return;\n        }\n        const htmlContent = result.value;\n        const textContent = extractTextFromHtml(htmlContent);\n        console.log('Scanning email content for sensitive keywords...');\n        const foundKeywords = scanForSensitiveKeywords(textContent);\n        if (foundKeywords.length > 0) {\n            console.log('Sensitive keywords found:', foundKeywords);\n            const keywordList = foundKeywords.join(', ');\n            const errorMessage = `This email contains sensitive keywords (${keywordList}). Please review before sending.`;\n            // Block the send and show notification\n            event.completed({\n                allowEvent: false,\n                errorMessage: errorMessage\n            });\n        }\n        else {\n            console.log('No sensitive keywords found, allowing send');\n            // Allow the email to be sent\n            event.completed({ allowEvent: true });\n        }\n    });\n}\n/**\n * Handler for appointment send events (calendar invitations)\n * @param event - The Office.js event object\n */\nfunction onAppointmentSendHandler(event) {\n    console.log('Appointment send handler triggered');\n    // Get the current item (appointment being sent)\n    const item = Office.context.mailbox.item;\n    if (!item) {\n        console.error('No item found');\n        event.completed({ allowEvent: true });\n        return;\n    }\n    // Get the body of the appointment\n    item.body.getAsync(Office.CoercionType.Html, (result) => {\n        if (result.status === Office.AsyncResultStatus.Failed) {\n            console.error('Failed to get appointment body:', result.error);\n            // Allow sending if we can't get the body\n            event.completed({ allowEvent: true });\n            return;\n        }\n        const htmlContent = result.value;\n        const textContent = extractTextFromHtml(htmlContent);\n        // Also check the subject line for appointments\n        const subject = item.subject || '';\n        const fullContent = `${subject} ${textContent}`;\n        console.log('Scanning appointment content for sensitive keywords...');\n        const foundKeywords = scanForSensitiveKeywords(fullContent);\n        if (foundKeywords.length > 0) {\n            console.log('Sensitive keywords found:', foundKeywords);\n            const keywordList = foundKeywords.join(', ');\n            const errorMessage = `This appointment contains sensitive keywords (${keywordList}). Please review before sending.`;\n            // Block the send and show notification\n            event.completed({\n                allowEvent: false,\n                errorMessage: errorMessage\n            });\n        }\n        else {\n            console.log('No sensitive keywords found, allowing send');\n            // Allow the appointment to be sent\n            event.completed({ allowEvent: true });\n        }\n    });\n}\n// Register the event handlers\n(function () {\n    \"use strict\";\n    Office.onReady(() => {\n        console.log('Office.js is ready, registering event handlers');\n        // Make handlers available globally for manifest\n        window.onMessageSendHandler = onMessageSendHandler;\n        window.onAppointmentSendHandler = onAppointmentSendHandler;\n    });\n})();\n// Export for potential use in other modules\nexport { onMessageSendHandler, onAppointmentSendHandler, scanForSensitiveKeywords };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"taskpane\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Taskpane functionality for the Sensitive Data Scanner\n */\n/// <reference path=\"../types/office.d.ts\" />\n// Import the scanning functionality from commands\nimport { scanForSensitiveKeywords } from '../commands/commands';\n/**\n * Extracts text content from HTML body\n * @param htmlContent - HTML content to extract text from\n * @returns Plain text content\n */\nfunction extractTextFromHtml(htmlContent) {\n    if (!htmlContent)\n        return '';\n    // Remove HTML tags and decode common HTML entities\n    const textContent = htmlContent\n        .replace(/<[^>]*>/g, ' ') // Remove HTML tags\n        .replace(/&nbsp;/g, ' ') // Replace non-breaking spaces\n        .replace(/&amp;/g, '&') // Decode ampersands\n        .replace(/&lt;/g, '<') // Decode less than\n        .replace(/&gt;/g, '>') // Decode greater than\n        .replace(/&quot;/g, '\"') // Decode quotes\n        .replace(/&#39;/g, \"'\") // Decode apostrophes\n        .replace(/\\s+/g, ' ') // Replace multiple whitespace with single space\n        .trim();\n    return textContent;\n}\n/**\n * Test the scanner on the current email\n */\nfunction testCurrentEmail() {\n    const resultDiv = document.getElementById('test-result');\n    if (!resultDiv)\n        return;\n    // Clear previous results\n    resultDiv.innerHTML = '';\n    resultDiv.className = '';\n    const item = Office.context.mailbox.item;\n    if (!item) {\n        resultDiv.innerHTML = '<div class=\"test-result-error\">No email is currently open for testing.</div>';\n        return;\n    }\n    // Show loading state\n    resultDiv.innerHTML = '<div class=\"test-result-info\">Scanning current email...</div>';\n    // Get the body of the current item\n    item.body.getAsync(Office.CoercionType.Html, (result) => {\n        if (result.status === Office.AsyncResultStatus.Failed) {\n            resultDiv.innerHTML = '<div class=\"test-result-error\">Failed to read email content.</div>';\n            return;\n        }\n        const htmlContent = result.value;\n        const textContent = extractTextFromHtml(htmlContent);\n        // Also get subject if available\n        const subject = item.subject || '';\n        const fullContent = `${subject} ${textContent}`;\n        const foundKeywords = scanForSensitiveKeywords(fullContent);\n        if (foundKeywords.length > 0) {\n            const keywordList = foundKeywords.join(', ');\n            resultDiv.innerHTML = `<div class=\"test-result-warning\">⚠️ Sensitive keywords found: <strong>${keywordList}</strong><br>This email would be blocked from sending.</div>`;\n        }\n        else {\n            resultDiv.innerHTML = '<div class=\"test-result-success\">✅ No sensitive keywords detected. This email would be allowed to send.</div>';\n        }\n    });\n}\n/**\n * Initialize the taskpane\n */\nfunction initialize() {\n    // Check if Office is ready\n    if (typeof Office !== 'undefined') {\n        document.getElementById(\"sideload-msg\").style.display = \"none\";\n        document.getElementById(\"app-body\").style.display = \"flex\";\n        // Bind the test scanner button\n        const testButton = document.getElementById('test-scanner');\n        if (testButton) {\n            testButton.addEventListener('click', testCurrentEmail);\n        }\n    }\n    else {\n        // Show sideload message if Office is not available\n        document.getElementById(\"sideload-msg\").style.display = \"flex\";\n        document.getElementById(\"app-body\").style.display = \"none\";\n    }\n}\n// Initialize when Office is ready\nOffice.onReady((info) => {\n    initialize();\n});\n// Also initialize immediately in case Office is already ready\nif (typeof Office !== 'undefined') {\n    initialize();\n}\n","// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \"<!DOCTYPE html>\\r\\n<html>\\r\\n<head>\\r\\n    <meta charset=\\\"UTF-8\\\" />\\r\\n    <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\" />\\r\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\">\\r\\n    <title>Sensitive Data Scanner</title>\\r\\n    \\r\\n    <!-- Office JavaScript API -->\\r\\n    <\" + \"script type=\\\"text/javascript\\\" src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script>\\r\\n    \\r\\n    <!-- Local CSS -->\\r\\n    <link rel=\\\"stylesheet\\\" href=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\" />\\r\\n</head>\\r\\n<body class=\\\"ms-font-m ms-welcome ms-Fabric\\\">\\r\\n    <header class=\\\"ms-welcome__header ms-bgColor-neutralLighter\\\">\\r\\n        <div class=\\\"logo-placeholder\\\">🛡️</div>\\r\\n        <h1 class=\\\"ms-font-su\\\">Sensitive Data Scanner</h1>\\r\\n    </header>\\r\\n    <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\">\\r\\n        <h2 class=\\\"ms-font-xl\\\">Please sideload your add-in to see app body.</h2>\\r\\n    </section>\\r\\n    <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display: none;\\\">\\r\\n        <h2 class=\\\"ms-font-xl\\\">Protect your sensitive information</h2>\\r\\n        <div class=\\\"feature-section\\\">\\r\\n            <p class=\\\"ms-font-m\\\">This add-in automatically scans your emails and calendar invitations for sensitive keywords before sending.</p>\\r\\n            \\r\\n            <h3 class=\\\"ms-font-l\\\">Protected Keywords:</h3>\\r\\n            <ul id=\\\"keywords-list\\\" class=\\\"keywords-list\\\">\\r\\n                <li>confidential</li>\\r\\n                <li>internal use only</li>\\r\\n                <li>secret</li>\\r\\n                <li>project-alpha</li>\\r\\n                <li>classified</li>\\r\\n                <li>restricted</li>\\r\\n                <li>proprietary</li>\\r\\n                <li>do not distribute</li>\\r\\n                <li>sensitive</li>\\r\\n                <li>private and confidential</li>\\r\\n            </ul>\\r\\n            \\r\\n            <div class=\\\"status-section\\\">\\r\\n                <h3 class=\\\"ms-font-l\\\">Scanner Status:</h3>\\r\\n                <p id=\\\"scanner-status\\\" class=\\\"ms-font-m status-active\\\">✅ Active - Monitoring outgoing messages</p>\\r\\n            </div>\\r\\n            \\r\\n            <div class=\\\"test-section\\\">\\r\\n                <h3 class=\\\"ms-font-l\\\">Test Scanner:</h3>\\r\\n                <p class=\\\"ms-font-s\\\">Try composing an email with the word \\\"confidential\\\" to test the scanner.</p>\\r\\n                <button id=\\\"test-scanner\\\" class=\\\"ms-Button ms-Button--primary\\\">\\r\\n                    <span class=\\\"ms-Button-label\\\">Test Current Email</span>\\r\\n                </button>\\r\\n                <div id=\\\"test-result\\\" style=\\\"margin-top: 10px;\\\"></div>\\r\\n            </div>\\r\\n        </div>\\r\\n    </main>\\r\\n</body>\\r\\n</html>\\r\\n\";\n// Exports\nexport default code;"],"names":["SENSITIVE_KEYWORDS","scanForSensitiveKeywords","content","normalizedContent","toLowerCase","foundKeywords","keyword","includes","push","extractTextFromHtml","htmlContent","textContent","replace","trim","onMessageSendHandler","event","console","log","item","Office","context","mailbox","error","completed","allowEvent","body","getAsync","CoercionType","Html","result","status","AsyncResultStatus","Failed","value","length","keywordList","join","errorMessage","onAppointmentSendHandler","subject","fullContent","onReady","window","testCurrentEmail","resultDiv","document","getElementById","innerHTML","className","initialize","style","display","testButton","addEventListener","info"],"sourceRoot":""}